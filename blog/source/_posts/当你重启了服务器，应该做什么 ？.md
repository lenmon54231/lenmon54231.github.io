---
title: 当你重启了服务器，应该做什么 ？
date: 2020-07-12 17:16:26
tags: [centsos]
---

<meta name="referrer" content="no-referrer"/>

## 当你重启了服务器，应该做什么 ？(配置ffmpeg)

更新了一些视频处理功能上去，重启服务器数据库请求500，记录一下重启后需要做什么

9月25日，配置ffmpeg环境变量到centOS

<!-- more -->

> 根据新添加的功能去检查是否有依赖未安装

### 服务器是否正常启动

登录阿里云后台，通过官网使用远程链接登录，检查是否启动正确

### 检查nginx是否启动

输入网址limeng.website。找不到地址，则使用ip进行访问，还是访问不到，需要检查nginx，重启

```js
cd /www/server/nginx/sbin
./nginx 
或者 ./nginx -s reload
```

### 检查mongdb是否启动

可以访问网页，但是不能链接数据库，通过远程连接，启动node

```js
cd /BLOG/server
node index
```

### 9月25日记录

本次是因为更新ffmpeg处理视频功能，上传server后，引入的fluent-ffmpeg没有在centOS中安装。需要安装后再启动 node

1. [官网下载linux版本的ffmpeg源码包 ffmpeg-4.1.tar.xz](https://johnvansickle.com/ffmpeg/release-source/)

2. 使用xftp将源码包ffmpeg-4.1.tar.xz上传至linux主机，解压源码包

   ```js
   cd /usr/local/
   mkdir ffmpeg    #在usr/local目录下创建ffmpeg目录
   cd /usr/local/ffmpeg
   tar xvJf ffmpeg-4.1.tar.xz
   cd ffmpeg-4.1
   yum install gcc 
   yum install yasm 
   ./configure --enable-shared --prefix=/usr/local/ffmpeg
   make
   make install
   ```

3. 编译完成后，需要修改path

   ```js
   vim /etc/ld.so.conf
   ```

   ```js
   内容如下：
   include ld.so.conf.d/*.conf
   /usr/local/ffmpeg/lib/
   ```

   输入**ldconfig**使修改生效。

   ```js
   ldconfig
   ```

4. 查看版本

   ```JS
   /usr/local/ffmpeg/ffmpeg-4.1/ffmpeg -version
   ```

5. 配置环境变量

   ```JS
   # vim /etc/profile
   ```

   ```js
   内容如下：
   #set ffmpeg environment
   PATH=$PATH:/usr/local/ffmpeg/bin
   export PATH
   ```

   ```js
   source /etc/profile #使配置生效
   ```

   ```js
   ffmpeg -version
   ```

   最终展示如下：可以在任意地方使用ffmpeg

   ![img](https://img2018.cnblogs.com/blog/1486162/201907/1486162-20190710113208809-336235091.png)

